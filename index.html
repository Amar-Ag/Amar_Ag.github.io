<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Amar Agrawal, Amar Agrawal Portfolio">
    <meta name="description" content="Graphic and Designer, R&D manager, R Programmer, soon to be fullstack developer">
    <!--    <link rel="icon" href="">-->
    <title>Amar Agrawal|Portfolio</title>
    <style>
        .main {
            text-align: center;
        }
    </style>
</head>
<body>
<div id="preLoader">Loading...</div>
<div class="main" id="mainContainer" hidden>
    <img
            height="100"
            width="100"
            id="ProfileImage"
    />
    <h2 id="fullName"></h2>
    <p id="personalBio"></p>
    <h5 id="followersInfo"></h5>
    <p>
        Check me out on <a id="githubLink">GitHub</a> & <a href="https://www.linkedin.com/in/amar-agrawal-5370a814b/">LinkedIn</a>
    </p>
    <a class="twitter-timeline" data-width="300" data-height="400"
       data-theme="dark" href="https://twitter.com/amar_speaks?ref_src=twsrc%5Etfw">Tweets by amar_speaks</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</div>
<script>
    fetch("https://api.github.com/users/Amar-Ag")
        .then(response => response.json())
        .then(function (data) {
            console.log(data)
            let followerCount = data['followers']
            let followerString = 'I am followed on GitHub by ' + followerCount + ' people.'
            document.getElementById('ProfileImage').src = data['avatar_url']
            document.getElementById('fullName').textContent = data['name']
            document.getElementById('personalBio').textContent = data['bio']
            document.getElementById('followersInfo').textContent = followerString
            document.getElementById('githubLink').href = data['html_url']

            let reposUrl = data['repos_url']
            const limitPerPage = 20;

            const getRepos = async function (pageNo = 1) {

                let actualUrl = reposUrl + `?page=${pageNo}&limit=${limitPerPage}`;
                var apiResults = await fetch(actualUrl)
                    .then(resp => {
                        return resp.json();
                    });
                return apiResults;
            }

            const getEntireRepos = async function (pageNo = 1) {
                const results = await getRepos(pageNo);
                console.log("Retreiving data from API for page : " + pageNo);
                if (results.length > 0) {
                    return results.concat(await getEntireRepos(pageNo + 1));
                } else {
                    return results;
                }
            };


            (async () => {
                const entireList = await getEntireRepos();
                console.log(entireList);
                let allRepos = entireList.map(entireList => entireList.name)
                let allReposLinks = entireList.map(entireList => entireList.html_url)
                console.log(allRepos)
                console.log(allReposLinks)
            })();
            document.getElementById('preLoader').hidden = true
            document.getElementById('mainContainer').hidden = false
        })
</script>
</body>
</html>